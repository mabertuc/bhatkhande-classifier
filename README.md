# bhatkhande-classifier
A CNN that classifies characters with chromatic alterations in a Bhatkhande corpus.

## Installation:

This project requires Python 3.7.4, Keras 2.2.4, Pillow 6.1.0, TensorFlow 1.14.0, and music21 5.7.0. Run 
```
pip install -e .
``` 
in your environment from the root directory of the project to install Keras, Pillow, TensorFlow, and music21.

## Usage:

Running 
```
python classifier/train.py
``` 
from the root directory of the project will train the model. classifier/train.py requires that a directory called samples  containing all the sample character images exists in the classifier directory. classifier/train.py will then generate the desired number of character images for each character (specified in line 252 of classifier/train.py) and distribute them to the classifier/train and classifier/validation directories according to the character type and the percentage of images used for training (specified in line 253 of classifier/train.py); all the relevant directories (classifier/train and classifier/validation) and files (classifier/model.json and classifier/model.h5) will be generated by classifier/train.py. Print messages throughout classifier/train.py display the current status.

Running 
```
python classifier/predict.py
``` 
from the root directory of the project will make predictions based on the model that was previously created. classifier/predict.py requires that model.json, model.h5, a directory called samples (containing all the sample character images), and a directory containing all the images used for the predictions are in the classifier directory; modify line 135 in classifier/predict.py so that the name of the directory containing all the images used for the predictions is correct. For each image, classifier/predict.py will print the prediction for the image as well as a probability assigned to that prediction; after all the predictions have been made, a score will be shown. IMPORTANT: running classifier/predict.py will modify the images in the directory containing all the images used for the predictions so that they can be processed by the model. Avoid using originals if you do not want the images to be modified.

## Testing:

Run 
```
pip install -e .[dev]
``` 
from the root directory of the project to install pytest in addition to the other packages. Then run 
```
pytest tests
``` 
from the root directory of the project to run all the tests.

## Authors:

If you have any questions, please contact me atÂ <mabertuc.dev@gmail.com>.

## License:

This project is licensed under the MIT license.
