# bhatkhande-classifier
A CNN that classifies characters with chromatic alterations in a Bhatkhande corpus.

## Installation:

This project requires Python 3.7.2, Keras 2.2.4, Pillow 6.0.0, and TensorFlow 1.13.1. Run 
```
pip install -e .
``` 
in your environment from the root directory of the project to install Keras, Pillow, and TensorFlow.

## Usage:

Running 
```
python classifier/train.py
``` 
from the root directory of the project will train the model. classifier/train.py requires that a directory containing all the sample images exists in the classifier directory (e.g., there is currently a samples directory in the classifier directory containing all the sample images); modify line 228 in classifier/train.py so that the name of the directory is correct, if necessary. All the relevant directories (classifier/train and classifier/validation) and files (classifier/model.json and classifier/model.h5) will be generated by classifier/train.py. Print messages throughout classifier/train.py display the current status.

Running 
```
python classifier/predict.py
``` 
from the root directory of the project will make predictions based on the model that was previously created. classifier/predict.py requires that model.json, model.h5, and a directory containing all the images used for the predictions are in the classifier directory; modify line 73 in classifier/predict.py so that the name of the directory containing all the images used for the predictions is correct. For each image, classifier/predict.py will print the prediction for the image as well as a probability assigned to that prediction. IMPORTANT: running classifier/predict.py will modify the images in the directory containing all the images used for the predictions so that they can be processed by the model. Avoid using originals if you do not want the images to be modified.

## Testing:

Run 
```
pip install -e .[dev]
``` 
from the root directory of the project to install pytest in addition to the other packages. Then run 
```
pytest tests
``` 
from the root directory of the project to run all the tests.

## Authors:

If you have any questions, please contact me atÂ <mabertuc.dev@gmail.com>.

## License:

This project is licensed under the MIT license.
